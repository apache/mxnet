I"µ<!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at -->

<!---   http://www.apache.org/licenses/LICENSE-2.0 -->

<!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. -->

<h1 id="mxnet---perl-api">MXNet - Perl API</h1>

<p>MXNet supports the Perl programming language. The MXNet Perl package brings flexible and efficient GPU
computing and state-of-art deep learning to Perl. It enables you to write seamless tensor/matrix computation with multiple GPUs in Perl.
It also lets you construct and customize the state-of-art deep learning models in Perl,
  and apply them to tasks, such as image classification and data science challenges.</p>

<p>One important thing to internalize is that Perl interface is written to be as close as possible to the Pythonâ€™s API,
so most if not all of Pythonâ€™s documentation and examples should just work in Perl after making few
changes in order to make the code a bit more Perlish. In nutshell just add $ sigils and replace . = \n with -&gt; =&gt; ; and in 99% of cases
thatâ€™s all that is needed there.
In addition please refer to <a href="https://metacpan.org/release/AI-MXNet">excellent metacpan doc interface</a> and to very detailed
<a href="/api/python">MXNet Python API Documentation</a>.</p>

<p>AI::MXNet supports new imperative PyTorch like Gluon MXNet interface. Please get acquainted with this new interface
at <a href="https://www.d2l.ai/">Dive into Deep Learning</a>.</p>

<p>For specific Perl Gluon usage please refer to Perl examples and tests directories on github, but be assured that the Python and Perl usage
are extremely close in order to make the use of the Python Gluon docs and examples as easy as possible.</p>

<p>AI::MXNet is seamlessly glued with <a href="https://metacpan.org/release/PDL">PDL</a>, the C++ level state can be easily initialized from PDL and the results can be
transferred to PDL objects in order to allow you to use all the glory and power of the PDL!</p>

<p>Here is how you can perform tensor or matrix computation in Perl with AI::MXNet and PDL:</p>

<div class="language-perl highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">use</span> <span class="nn">AI::</span><span class="nv">MXNet</span> <span class="sx">qw(mx)</span><span class="p">;</span> <span class="c1"># creates 'mx' module on the fly with the interface close to the Python's API</span>

<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="nv">$arr</span> <span class="o">=</span> <span class="nv">mx</span><span class="o">-&gt;</span><span class="nv">nd</span><span class="o">-&gt;</span><span class="nv">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="o">&lt;</span><span class="nn">AI::MXNet::</span><span class="nv">NDArray</span> <span class="mi">2</span><span class="nv">x3</span> <span class="nv">@cpu</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span>

<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="nn">Data::Dumper::</span><span class="nv">Dumper</span><span class="p">(</span><span class="nv">$arr</span><span class="o">-&gt;</span><span class="nv">shape</span><span class="p">)</span>
<span class="nv">$VAR1</span> <span class="o">=</span> <span class="p">[</span>
          <span class="mi">2</span><span class="p">,</span>
          <span class="mi">3</span>
        <span class="p">];</span>

<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="p">((</span><span class="nv">$arr</span><span class="o">*</span><span class="mi">2</span><span class="p">)</span><span class="o">-&gt;</span><span class="nv">aspdl</span><span class="p">)</span> <span class="c1">## converts AI::MXNet::NDArray object to PDL object</span>

<span class="p">[</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">2</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>

<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="nv">$arr</span> <span class="o">=</span> <span class="nv">mx</span><span class="o">-&gt;</span><span class="nv">nd</span><span class="o">-&gt;</span><span class="nv">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]])</span> <span class="c1">## init the NDArray from Perl array ref given in PDL::pdl constructor format</span>
<span class="o">&lt;</span><span class="nn">AI::MXNet::</span><span class="nv">NDArray</span> <span class="mi">2</span><span class="nv">x2</span> <span class="nv">@cpu</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">&gt;</span>
<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="nv">$arr</span><span class="o">-&gt;</span><span class="nv">aspdl</span>

<span class="p">[</span>
 <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">]</span>

<span class="c1">## init the NDArray from PDL but be aware that PDL methods expect the dimensions order in column major format</span>
<span class="c1">## AI::MXNet::NDArray is row major</span>
<span class="nv">pdl</span><span class="o">&gt;</span> <span class="k">print</span> <span class="nv">mx</span><span class="o">-&gt;</span><span class="nv">nd</span><span class="o">-&gt;</span><span class="nv">array</span><span class="p">(</span><span class="nv">sequence</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span><span class="o">-&gt;</span><span class="nv">aspdl</span> <span class="c1">## 3 rows, 2 columns</span>

<span class="p">[</span>
 <span class="p">[</span><span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Export/import to/from sparse MXNet tensors are supported via <a href="https://metacpan.org/release/PDL-CCS">PDL::CCS</a>.
Please check out the examples directory for the examples on how to use the sparse matrices.</p>
:ET