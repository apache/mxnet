I"è<!--- Licensed to the Apache Software Foundation (ASF) under one -->
<!--- or more contributor license agreements.  See the NOTICE file -->
<!--- distributed with this work for additional information -->
<!--- regarding copyright ownership.  The ASF licenses this file -->
<!--- to you under the Apache License, Version 2.0 (the -->
<!--- "License"); you may not use this file except in compliance -->
<!--- with the License.  You may obtain a copy of the License at -->

<!---   http://www.apache.org/licenses/LICENSE-2.0 -->

<!--- Unless required by applicable law or agreed to in writing, -->
<!--- software distributed under the License is distributed on an -->
<!--- "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY -->
<!--- KIND, either express or implied.  See the License for the -->
<!--- specific language governing permissions and limitations -->
<!--- under the License. -->

<h1 id="infer-api">Infer API</h1>
<p>The MXNet Scala Infer API provides you with model loading and inference functionality using the MXNet Scala package.</p>

<h2 id="prerequisites">Prerequisites</h2>
<p>To use the Infer API you must first install the MXNet Scala package. Instructions for this are provided in the following variations:</p>
<ul>
  <li><a href="mxnet_scala_on_intellij">Tutorial for setting up a project in the IntelliJ IDE</a></li>
  <li><a href="/get_started/ubuntu_setup.html#install-the-mxnet-package-for-scala">Installing the MXNet Scala Package for macOS</a></li>
  <li><a href="/get_started/ubuntu_setup.html#install-the-mxnet-package-for-scala">Installing the MXNet Scala for Linux</a></li>
</ul>

<h2 id="inference">Inference</h2>
<p>The Scala Infer API includes both single image and batch modes. Here is an example of running inference on a single image by using the <code class="highlighter-rouge">ImageClassifier</code> class. A complete <a href="https://github.com/apache/incubator-mxnet/blob/master/scala-package/examples/src/main/scala/org/apache/mxnetexamples/infer/imageclassifier/ImageClassifierExample.scala">image classification example</a> using ResNet-152 is provided in the <a href="https://github.com/apache/incubator-mxnet/tree/master/scala-package/examples/src/main/scala/org/apache/mxnetexamples">Scala packageâ€™s example folder</a>. This example also demonstrates inference with batches of images.</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">runInferenceOnSingleImage</span><span class="o">(</span><span class="n">modelPathPrefix</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">inputImagePath</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span>
                              <span class="n">context</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">Context</span><span class="o">])</span><span class="k">:</span>
<span class="kt">IndexedSeq</span><span class="o">[</span><span class="kt">IndexedSeq</span><span class="o">[(</span><span class="kt">String</span>, <span class="kt">Float</span><span class="o">)]]</span> <span class="k">=</span> <span class="o">{</span>
  <span class="k">val</span> <span class="nv">dType</span> <span class="k">=</span> <span class="nv">DType</span><span class="o">.</span><span class="py">Float32</span>
  <span class="k">val</span> <span class="nv">inputShape</span> <span class="k">=</span> <span class="nc">Shape</span><span class="o">(</span><span class="mi">1</span><span class="o">,</span> <span class="mi">3</span><span class="o">,</span> <span class="mi">224</span><span class="o">,</span> <span class="mi">224</span><span class="o">)</span>

  <span class="k">val</span> <span class="nv">inputDescriptor</span> <span class="k">=</span> <span class="nc">IndexedSeq</span><span class="o">(</span><span class="nc">DataDesc</span><span class="o">(</span><span class="s">"data"</span><span class="o">,</span> <span class="n">inputShape</span><span class="o">,</span> <span class="n">dType</span><span class="o">,</span> <span class="s">"NCHW"</span><span class="o">))</span>

  <span class="c1">// Create object of ImageClassifier class</span>
  <span class="k">val</span> <span class="nv">imgClassifier</span><span class="k">:</span> <span class="kt">ImageClassifier</span> <span class="o">=</span> <span class="k">new</span>
      <span class="nc">ImageClassifier</span><span class="o">(</span><span class="n">modelPathPrefix</span><span class="o">,</span> <span class="n">inputDescriptor</span><span class="o">,</span> <span class="n">context</span><span class="o">)</span>

  <span class="c1">// Loading single image from file and getting BufferedImage</span>
  <span class="k">val</span> <span class="nv">img</span> <span class="k">=</span> <span class="nv">ImageClassifier</span><span class="o">.</span><span class="py">loadImageFromFile</span><span class="o">(</span><span class="n">inputImagePath</span><span class="o">)</span>

  <span class="c1">// Running inference on single image</span>
  <span class="k">val</span> <span class="nv">output</span> <span class="k">=</span> <span class="nv">imgClassifier</span><span class="o">.</span><span class="py">classifyImage</span><span class="o">(</span><span class="n">img</span><span class="o">,</span> <span class="nc">Some</span><span class="o">(</span><span class="mi">5</span><span class="o">))</span>

  <span class="n">output</span>
<span class="o">}</span>
</code></pre></div></div>

<h2 id="related-resources">Related Resources</h2>
<ul>
  <li><a href="/api/scala/docs/api/#org.apache.mxnet.infer.package">Infer API Scaladocs</a></li>
  <li><a href="https://github.com/apache/incubator-mxnet/tree/master/scala-package/examples/src/main/scala/org/apache/mxnetexamples/infer/objectdetector">Single Shot Detector Inference Example</a></li>
  <li><a href="https://github.com/apache/incubator-mxnet/tree/master/scala-package/examples/src/main/scala/org/apache/mxnetexamples/infer/imageclassifier">Image Classification Example</a></li>
</ul>
:ET